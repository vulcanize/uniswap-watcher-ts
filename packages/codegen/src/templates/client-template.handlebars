//
// Copyright 2021 Vulcanize, Inc.
//

import { gql } from '@apollo/client/core';
import { GraphQLClient, GraphQLConfig } from '@vulcanize/ipld-eth-client';

import { queries, mutations, subscriptions } from './gql';

export class Client {
  _config: GraphQLConfig;
  _client: GraphQLClient;

  constructor (config: GraphQLConfig) {
    this._config = config;

    this._client = new GraphQLClient(config);
  }

  {{#each queries as | query |}}
  // eslint-disable-next-line camelcase
  async get{{capitalize query.name tillIndex=1}} (blockHash: string, contractAddress: string
  {{~#each query.params}}, {{this.name}}: {{this.type~}} {{/each}}): Promise<any> {
    const { {{query.name}} } = await this._client.query(
      gql(queries.{{query.name}}),
      { blockHash, contractAddress
      {{~#each query.params}}, {{this.name~}} {{/each}} }
    );

    return {{query.name}};
  }

  {{/each}}
}
